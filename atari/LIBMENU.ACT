; Library: LIBMENU.ACT›; Author.: Wade Ripkowski›; Desc...: Menu Routines-400/800›; Date...: 2016.04›; License: GNU General Public License v3.0›; Revised: 2021.01.05 MenuV: Add -= to nav›;          2021.01.12 MenuV: Fix item highlight width›;          2021.01.20 MenuV: Uninverse on exit flag›;                            Start item # param ››; Requires DEFINES.ACT be loaded 1st!›; Requires LIBWIN.ACT be loaded 1st!››; --------------------------------------›; Proc..: MenuV(BYTE bN,x,y,bI,bD,bS CHAR POINTER pS)›; Desc..: Vertical Menu›; Params: bN = number of window handle›;         x = column for cursor›;         y = row for cursor›;         bI = Uninverse flag (WINVON=on)›;         bD = start item #›;         bS = width of menu item›;         pS = menu item string›; --------------------------------------›BYTE FUNC MenuV(BYTE bN,x,y,bI,bD,bS CHAR POINTER pS)›  BYTE bL,bR,bP,bC,bT,bK›  CHAR ARRAY cL(39)››  ; Set start item number ›  bR=bD››  ; Compute # items based on width›  bC=pS(0)/bS›           ›  ; Repeat until done›  DO›    ; Display each item›    for bL=0 to bC        ›    DO›      ; Compute menu item pos in pS ›      bP=(bL*bS)+1›                   ›      ; Copy menu item str from pS   ›      SCopyS(cL,pS,bP,bP+bS-1)    ››      ; If itm 1, inverse›      if bL+1=bR then›        for bT=1 to cL(0)›        DO ›          cL(bT)==!128›        OD›      fi›      ›      ; Print item at row count›      WPrint(bN,x,y+bL,cL)›    OD››    ; Get key     ›    bK=WaitKC()››    ; Process key›    if bK=KDOWN or bK=KEQUAL or bK=KRIGHT or bK=KASTER then›      bR==+1›      if bR>bC then bR=1 fi››    elseif bK=KUP or bK=KMINUS or bK=KLEFT or bK=KPLUS then›      bR==-1›      if bR<1 then bR=bC fi ›    fi››    ; Set last selected item before›    ; checking ESC/TAB/ENTER›    bL=bR››    ; If ESC, set choice to XESC (0)›    if bK=KESC then›      bR=XESC›      exit›            ›    ; For TAB, set choice to XTAB (99)›    elseif bK=KTAB then›      bR=XTAB›      exit››    elseif bK=KENTER then›      exit›    fi›  OD››  ; Uninverse last selection if asked›  if bI=WOFF then›    bP=((bL-1)*bS)+1›    SCopyS(cL,pS,bP,bP+bS-1)›    WPrint(bN,x,y+bL-1,cL)›  fi›RETURN(bR)››MODULE››